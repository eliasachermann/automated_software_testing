SQL:
CREATE TABLE IF NOT EXISTS t_Z8e (c_lf9pfREDb4 TEXT COLLATE BINARY, c_ZVUpD9B INTEGER PRIMARY KEY AUTOINCREMENT);
CREATE TABLE IF NOT EXISTS t_6ajzdsq (c_cGgjjh TEXT, c_PP9YKZKj INTEGER DEFAULT 965669, c_IkJYD8su4U REAL, c_yyzsZn INTEGER DEFAULT NULL);
CREATE TABLE IF NOT EXISTS t_CIHTOVS5FH (c_x0P54d INTEGER, c_VewGos REAL, c_EZGfrb REAL, c_lw3BBW TEXT, c_T3cmCSyAYJ NUMERIC, c_Y2B TEXT DEFAULT 'g9rUqiizQt', c_yfu1u REAL DEFAULT 690178.5844, c_QuACGN TEXT, PRIMARY KEY (c_x0P54d, c_Y2B));
ALTER TABLE t_6ajzdsq RENAME TO t_Ka0RMc;
ALTER TABLE t_Z8e ADD COLUMN c_jQz6dJHeP NUMERIC;
WITH cte_v59 AS (SELECT 1) INSERT OR IGNORE INTO t_Z8e (c_lf9pfREDb4, c_ZVUpD9B, c_jQz6dJHeP) VALUES ('ObVBJ_9616', 96677819, 97501096);
REPLACE INTO t_Z8e (c_lf9pfREDb4, c_ZVUpD9B, c_jQz6dJHeP) VALUES ('Q2_9616', 97009777, 97395863);
INSERT OR REPLACE INTO t_Z8e (c_lf9pfREDb4, c_ZVUpD9B, c_jQz6dJHeP) VALUES ('5K_9616', 96165812, 97614078);
REPLACE INTO t_Z8e (c_lf9pfREDb4, c_ZVUpD9B, c_jQz6dJHeP) VALUES ('Q78TkJCeCZl_9616', 97322636, 97659452);
INSERT OR REPLACE INTO t_Z8e (c_lf9pfREDb4, c_ZVUpD9B, c_jQz6dJHeP) VALUES ('Lxiz1_9616', 97475118, 97745027), ('Mc82U7Dl6np24_19616', 197712847, 197278842);
REPLACE INTO t_CIHTOVS5FH (c_x0P54d, c_VewGos, c_EZGfrb, c_lw3BBW, c_T3cmCSyAYJ, c_Y2B, c_yfu1u, c_QuACGN) VALUES (96111836, -404347.6, 119368.4, 'FpfySVP9ax91TeMgPGI_9916', 99694351, 'ymWz5kDjWj1RD6MxS0tT_10116', -110331.08122, 'ant6s_10316');
INSERT OR IGNORE INTO t_CIHTOVS5FH (c_x0P54d, c_VewGos, c_EZGfrb, c_lw3BBW, c_T3cmCSyAYJ, c_Y2B, c_yfu1u, c_QuACGN) VALUES (96037284, -333031.21, -494945.94724999997, 'xlzpzdX7lpt76aZpOS_9916', 99997815, 'aFQ4_10116', -778344.53642, 'x_10316'), (196097310, 718037.9042100001, 791315.267, 'F8_19916', 199846314, 's_20116', -401967.19999999995, 'Mlu9JYrOmWn_20316');
WITH cte_1Q7 AS (SELECT 1) REPLACE INTO t_CIHTOVS5FH (c_x0P54d, c_VewGos, c_EZGfrb, c_lw3BBW, c_T3cmCSyAYJ, c_Y2B, c_yfu1u, c_QuACGN) VALUES (95878008, -410249.672162, -735279.44081, '5UdzW1Z392tcMVTLLp_9916', 100094936, '6M9GKJj_10116', -711241.34485, 'Yg6j8y6_10316'), (195779951, 181168.64044, -648533.9, 'TRSsBYK_19916', 200393072, 'eUwnC_20116', 267813.8422, 'pH7iynU3ocsEJ_20316');
INSERT OR REPLACE INTO t_CIHTOVS5FH (c_x0P54d, c_VewGos, c_EZGfrb, c_lw3BBW, c_T3cmCSyAYJ, c_Y2B, c_yfu1u, c_QuACGN) SELECT 96350313, 1017989.821777, 953922.733, 'EOv1QICmaRTs_9916', 99599546, 'yUi_10116', 453430.789, 'TABD39YdMLcZOLD_10316';
REPLACE INTO t_Ka0RMc (c_cGgjjh, c_PP9YKZKj, c_IkJYD8su4U, c_yyzsZn) VALUES ('pKiN4Y_9616', 97130678, 715014.101, 98356689), ('LBvbT4ABmJ_19616', 198076325, -286032.331, 200107326);
INSERT OR REPLACE INTO t_Ka0RMc (c_cGgjjh, c_PP9YKZKj, c_IkJYD8su4U, c_yyzsZn) VALUES ('p29sUYheHlE_9616', 96859489, -689084.58902, 98670245), ('MYqOoCj6_19616', 198155312, -147925.62099999998, 198302447);
REPLACE INTO t_Ka0RMc (c_cGgjjh, c_PP9YKZKj, c_IkJYD8su4U, c_yyzsZn) VALUES ('c1V8Q2VDsu_9616', 96245609, -320180.2274, 98502269), ('aLlOHe5ZavjY3wdL7MbU_19616', 197806349, 66344.53, 200071302);
INSERT OR IGNORE INTO t_Ka0RMc (c_cGgjjh, c_PP9YKZKj, c_IkJYD8su4U, c_yyzsZn) VALUES ('sNrpcMG5_9616', 96448251, 568810.6557, 98939810);
INSERT OR REPLACE INTO t_Ka0RMc (c_cGgjjh, c_PP9YKZKj, c_IkJYD8su4U, c_yyzsZn) VALUES ('f_9616', 97152191, -394630.737, 98486870);



BEGIN TRANSACTION;
UPDATE OR IGNORE t_Z8e SET c_ZVUpD9B = NULL WHERE ROWID = (SELECT MIN(ROWID) FROM t_Z8e);
REPLACE INTO t_Z8e (c_lf9pfREDb4, c_ZVUpD9B, c_jQz6dJHeP) VALUES ('aA48_9616', 97094216, 97711498);
COMMIT;

                SELECT c_Y2B, c_x0P54d,
                    ROW_NUMBER() OVER (PARTITION BY c_x0P54d) as row_num,
                    RANK() OVER (PARTITION BY c_x0P54d ORDER BY c_Y2B) as rank_val,
                    DENSE_RANK() OVER (PARTITION BY c_x0P54d ORDER BY c_Y2B) as dense_rank_val,
                    SUM(CASE WHEN typeof(c_Y2B) IN ('integer','real') THEN c_Y2B ELSE 0 END) 
                        OVER (PARTITION BY c_x0P54d ORDER BY c_Y2B 
                            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) as running_total,
                    LAG(CASE WHEN typeof(c_Y2B) IN ('integer','real') THEN c_Y2B ELSE 0 END, 1, 0) 
                        OVER (PARTITION BY c_x0P54d ORDER BY c_Y2B) as prev_value,
                    LEAD(CASE WHEN typeof(c_Y2B) IN ('integer','real') THEN c_Y2B ELSE 0 END, 1, 0) 
                        OVER (PARTITION BY c_x0P54d ORDER BY c_Y2B) as next_value
                FROM t_CIHTOVS5FH
                ORDER BY c_x0P54d, c_Y2B
                LIMIT 20;
                

                    SELECT 
                        t1.c_lf9pfREDb4,
                        (SELECT COUNT(*) FROM t_Z8e t2 WHERE t2.c_lf9pfREDb4 = t1.c_lf9pfREDb4) as same_value_count,
                        CASE WHEN EXISTS(SELECT 1 FROM t_Z8e t3 WHERE t3.c_lf9pfREDb4 > t1.c_lf9pfREDb4 LIMIT 1) 
                            THEN 'Not Max' ELSE 'Max' END as is_max_value,
                        (SELECT COUNT(*) FROM (
                            SELECT DISTINCT c_lf9pfREDb4 FROM t_Z8e
                        )) as distinct_values_count
                    FROM t_Z8e t1
                    WHERE t1.c_lf9pfREDb4 IN (
                        SELECT c_lf9pfREDb4 
                        FROM t_Z8e 
                        WHERE typeof(c_lf9pfREDb4) NOT IN ('null')
                        GROUP BY c_lf9pfREDb4
                        HAVING COUNT(*) > 0
                    )
                    ORDER BY (SELECT COUNT(*) FROM t_Z8e t4 WHERE t4.c_lf9pfREDb4 = t1.c_lf9pfREDb4) DESC
                    LIMIT 10;
                    
SELECT t_Z8e.c_jQz6dJHeP, t_Z8e.c_ZVUpD9B FROM t_Z8e ORDER BY t_Z8e.c_jQz6dJHeP DESC LIMIT 10;
SELECT t_CIHTOVS5FH.c_yfu1u, TYPEOF(t_CIHTOVS5FH.c_yfu1u) AS computed_c_yfu1u FROM t_CIHTOVS5FH LIMIT 10;

--- v3.26.0 ---
OUT:
6M9GKJj_10116|95878008|1|1|1|0|0|0
aFQ4_10116|96037284|1|1|1|0|0|0
ymWz5kDjWj1RD6MxS0tT_10116|96111836|1|1|1|0|0|0
yUi_10116|96350313|1|1|1|0|0|0
eUwnC_20116|195779951|1|1|1|0|0|0
s_20116|196097310|1|1|1|0|0|0
5K_9616|1|Not Max|7
ObVBJ_9616|1|Not Max|7
Q2_9616|1|Not Max|7
aA48_9616|1|Max|7
Q78TkJCeCZl_9616|1|Not Max|7
Lxiz1_9616|1|Not Max|7
Mc82U7Dl6np24_19616|1|Not Max|7
197278842|197712847
97745027|97475118
97711498|97094216
97659452|97322636
97614078|96165812
97501096|96677819
97395863|97009777
-110331.08122|real
-778344.53642|real
-401967.2|real
-711241.34485|real
267813.8422|real
453430.789|real

ERR:
Error: near line 24: datatype mismatch


--- v3.49.1 ---
OUT:
6M9GKJj_10116|95878008|1|1|1|0|0|0
aFQ4_10116|96037284|1|1|1|0|0|0
ymWz5kDjWj1RD6MxS0tT_10116|96111836|1|1|1|0|0|0
yUi_10116|96350313|1|1|1|0|0|0
eUwnC_20116|195779951|1|1|1|0|0|0
s_20116|196097310|1|1|1|0|0|0
5K_9616|1|Not Max|7
ObVBJ_9616|1|Not Max|7
Q2_9616|1|Not Max|7
aA48_9616|1|Max|7
Q78TkJCeCZl_9616|1|Not Max|7
Lxiz1_9616|1|Not Max|7
Mc82U7Dl6np24_19616|1|Not Max|7
197278842|197712847
97745027|97475118
97711498|97094216
97659452|97322636
97614078|96165812
97501096|96677819
97395863|97009777
-110331.08122|real
-778344.53642|real
-401967.2|real
-711241.34485|real
267813.8422|real
453430.789|real

ERR:
Runtime error near line 24: datatype mismatch (20)

