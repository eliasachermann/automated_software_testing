SQL:
PRAGMA freelist_count(1);
CREATE TABLE IF NOT EXISTS t_ON9JQPFQR (c_UW8D NUMERIC PRIMARY KEY, c_bKqe8jye7 TEXT COLLATE RTRIM, c_fHUi1iH6pB NUMERIC DEFAULT 819209, c_8iqqJH4bB NUMERIC DEFAULT 98786, c_1mQfKi5R TEXT DEFAULT 'xJahiCxL7DNXcTS8NUI', c_2eRyBnce0C TEXT DEFAULT '9dIfQHxf' COLLATE BINARY, FOREIGN KEY (c_bKqe8jye7) REFERENCES t_p3GUc(c_sXUjs));
CREATE TABLE IF NOT EXISTS t_iazsPD (c_gtXPmogy INTEGER PRIMARY KEY, c_fDM1 TEXT);
ALTER TABLE t_ON9JQPFQR RENAME TO t_qzxrhK;
ALTER TABLE t_iazsPD ADD COLUMN c_cnnMMcSKJ TEXT COLLATE BINARY;

                CREATE TRIGGER trg_vayVG
                AFTER UPDATE ON t_iazsPD
                BEGIN
                    SELECT RAISE(IGNORE) WHERE (SELECT count(*) FROM t_iazsPD) > 1000;
                END;
INSERT OR REPLACE INTO t_iazsPD (c_gtXPmogy, c_fDM1, c_cnnMMcSKJ) VALUES (90751935, 'c0wafrwQilOfXMN4W_9115', 'mwdaDgky9iMEAuM9oG_9215'), (189896164, '1ALCYHDZ_19115', 'qOqD_19215');
INSERT OR IGNORE INTO t_iazsPD (c_gtXPmogy, c_fDM1, c_cnnMMcSKJ) VALUES (89651911, 'yHaMsrEvcN_9115', 'J9iChDI04a4pR1gO_9215');
INSERT OR IGNORE INTO t_qzxrhK (c_UW8D, c_bKqe8jye7, c_fHUi1iH6pB, c_8iqqJH4bB, c_1mQfKi5R, c_2eRyBnce0C) VALUES (89700167, 'g7kuLWD_9115', 93141019, 93551408, 'jU_9415', 'Rtmc43Ss_9515');
INSERT OR IGNORE INTO t_qzxrhK (c_UW8D, c_bKqe8jye7, c_fHUi1iH6pB, c_8iqqJH4bB, c_1mQfKi5R, c_2eRyBnce0C) VALUES (90922968, '7xO8Vee_9115', 91891871, 92426949, 'BUt_9415', 'EQJj0z7I_9515'), (189651465, 'GtMbH9Q_19115', 192286299, 192353381, 'tz1D3MluK32c8S_19415', 'P7I6_19515');
BEGIN TRANSACTION;
INSERT OR IGNORE INTO t_iazsPD (c_gtXPmogy, c_fDM1, c_cnnMMcSKJ) VALUES (90474243, 'kCOQ94lJMHd3g_9115', 'RIq4Ru_9215');
INSERT OR REPLACE INTO t_iazsPD (c_gtXPmogy, c_fDM1, c_cnnMMcSKJ) SELECT 89222292, 'xzVOGCY20QPNTWl2f_9115', 'ThiqZWG4_9215';
UPDATE OR IGNORE t_iazsPD SET c_gtXPmogy = NULL WHERE ROWID = (SELECT MIN(ROWID) FROM t_iazsPD);
COMMIT;

                    SELECT 
                        t1.c_1mQfKi5R,
                        (SELECT COUNT(*) FROM t_qzxrhK t2 WHERE t2.c_1mQfKi5R = t1.c_1mQfKi5R) as same_value_count,
                        CASE WHEN EXISTS(SELECT 1 FROM t_qzxrhK t3 WHERE t3.c_1mQfKi5R > t1.c_1mQfKi5R LIMIT 1) 
                            THEN 'Not Max' ELSE 'Max' END as is_max_value,
                        (SELECT COUNT(*) FROM (
                            SELECT DISTINCT c_1mQfKi5R FROM t_qzxrhK
                        )) as distinct_values_count
                    FROM t_qzxrhK t1
                    WHERE t1.c_1mQfKi5R IN (
                        SELECT c_1mQfKi5R 
                        FROM t_qzxrhK 
                        WHERE typeof(c_1mQfKi5R) NOT IN ('null')
                        GROUP BY c_1mQfKi5R
                        HAVING COUNT(*) > 0
                    )
                    ORDER BY (SELECT COUNT(*) FROM t_qzxrhK t4 WHERE t4.c_1mQfKi5R = t1.c_1mQfKi5R) DESC
                    LIMIT 10;
                    
SELECT t_qzxrhK.c_bKqe8jye7, t_qzxrhK.c_fHUi1iH6pB, t_qzxrhK.c_2eRyBnce0C FROM t_qzxrhK LIMIT 10;

                SELECT DISTINCT t_qzxrhK.c_UW8D,
                    COUNT(*) OVER (PARTITION BY t_qzxrhK.c_UW8D) as window_count,
                    RANK() OVER (ORDER BY 
                            CASE WHEN typeof(t_qzxrhK.c_UW8D) IN ('null') THEN 0 
                            ELSE t_qzxrhK.c_UW8D END DESC,
                            t_qzxrhK.c_UW8D ASC     /* Only use columns that definitely exist */
                    ) as rank_val,
                    CASE WHEN t_qzxrhK.c_UW8D IS NULL THEN 'Unknown' ELSE 'Known' END as status
                FROM t_qzxrhK
                WHERE t_qzxrhK.c_UW8D IS NOT NULL
                GROUP BY t_qzxrhK.c_UW8D, t_qzxrhK.c_UW8D
                HAVING COUNT(*) > 0
                /* Only use columns that definitely exist in ORDER BY */
                ORDER BY t_qzxrhK.c_UW8D ASC, t_qzxrhK.c_UW8D ASC, window_count DESC
                LIMIT 20;
                

                SELECT t_qzxrhK.c_UW8D,
                    t_qzxrhK.c_UW8D,
                    SUM(CASE WHEN typeof(t_qzxrhK.c_UW8D) IN ('integer', 'real', 'numeric') THEN t_qzxrhK.c_UW8D ELSE 0 END) 
                        OVER (PARTITION BY t_qzxrhK.c_UW8D ORDER BY t_qzxrhK.c_UW8D ASC) as window_total
                FROM t_qzxrhK
                GROUP BY t_qzxrhK.c_UW8D, t_qzxrhK.c_UW8D
                HAVING SUM(CASE WHEN typeof(t_qzxrhK.c_UW8D) IN ('integer', 'real', 'numeric') THEN t_qzxrhK.c_UW8D ELSE 0 END) > 0
                ORDER BY window_total DESC, t_qzxrhK.c_UW8D ASC, t_qzxrhK.c_UW8D ASC
                LIMIT 10;
                

--- v3.26.0 ---
OUT:
0
jU_9415|1|Not Max|3
BUt_9415|1|Not Max|3
tz1D3MluK32c8S_19415|1|Max|3
g7kuLWD_9115|93141019|Rtmc43Ss_9515
7xO8Vee_9115|91891871|EQJj0z7I_9515
GtMbH9Q_19115|192286299|P7I6_19515
89700167|1|3|Known
90922968|1|2|Known
189651465|1|1|Known
189651465|189651465|189651465
90922968|90922968|90922968
89700167|89700167|89700167

ERR:
Error: near line 19: datatype mismatch


--- v3.49.1 ---
OUT:
0
jU_9415|1|Not Max|3
BUt_9415|1|Not Max|3
tz1D3MluK32c8S_19415|1|Max|3
g7kuLWD_9115|93141019|Rtmc43Ss_9515
7xO8Vee_9115|91891871|EQJj0z7I_9515
GtMbH9Q_19115|192286299|P7I6_19515
89700167|1|3|Known
90922968|1|2|Known
189651465|1|1|Known
189651465|189651465|189651465
90922968|90922968|90922968
89700167|89700167|89700167

ERR:
Runtime error near line 19: datatype mismatch (20)

