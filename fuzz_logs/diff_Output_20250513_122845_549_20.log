SQL:
PRAGMA automatic_index;
CREATE TABLE IF NOT EXISTS t_XP3o (c_oZlJWk TEXT DEFAULT 'JncRqZnzjSkouyM', c_H9fn2ZM INTEGER, c_OQ6HZnt NUMERIC PRIMARY KEY, c_yhpUg INTEGER DEFAULT 294337, c_XqFrBM0 REAL DEFAULT -532577.97, c_Rr6Nr NUMERIC DEFAULT -652091, c_aXRgQZqf NUMERIC, c_2t6hgl NUMERIC, FOREIGN KEY (c_Rr6Nr) REFERENCES t_00voT(c_3mxsP));
CREATE TABLE IF NOT EXISTS t_RyKA (c_7VKbFYLm TEXT, c_GkDm TEXT, UNIQUE (c_7VKbFYLm, c_GkDm));
CREATE TABLE IF NOT EXISTS t_XtYasJ (c_ilYbxWW4JN INTEGER, c_xMwO INTEGER DEFAULT 896365, c_S8Ikn NUMERIC, c_1cSWollN INTEGER, c_kPd3voP NUMERIC DEFAULT -934861, c_xBEHhUmfye NUMERIC, FOREIGN KEY (c_xBEHhUmfye) REFERENCES t_mYHR4(c_agg9q));
CREATE TABLE IF NOT EXISTS t_eXbmsREJ (c_5HieIXCQS INTEGER);
ALTER TABLE t_XtYasJ ADD COLUMN c_39sEIpBeuk NUMERIC;
ALTER TABLE t_XtYasJ ADD COLUMN c_d8xO5525hG NUMERIC;
INSERT OR REPLACE INTO t_XP3o (c_oZlJWk, c_H9fn2ZM, c_OQ6HZnt, c_yhpUg, c_XqFrBM0, c_Rr6Nr, c_aXRgQZqf, c_2t6hgl) VALUES ('aF67_9323', 94519643, 94991823, 96949100, -540740.324, 99005471, 99884134, 100836385);
REPLACE INTO t_XP3o (c_oZlJWk, c_H9fn2ZM, c_OQ6HZnt, c_yhpUg, c_XqFrBM0, c_Rr6Nr, c_aXRgQZqf, c_2t6hgl) VALUES ('TAnwh_9323', 94381578, 95304576, 95925853, 840326.01446, 98525080, 98872503, 100653278);
INSERT OR REPLACE INTO t_XP3o (c_oZlJWk, c_H9fn2ZM, c_OQ6HZnt, c_yhpUg, c_XqFrBM0, c_Rr6Nr, c_aXRgQZqf, c_2t6hgl) VALUES ('gzFrpp_9323', 94134880, 95215078, 96003343, 1045521.53, 97443735, 98439408, 100111425);
WITH cte_kGb AS (SELECT 1) INSERT OR REPLACE INTO t_XP3o (c_oZlJWk, c_H9fn2ZM, c_OQ6HZnt, c_yhpUg, c_XqFrBM0, c_Rr6Nr, c_aXRgQZqf, c_2t6hgl) VALUES ('RlGEx_9323', 93598844, 94339707, 95965434, 878876.5, 98325379, 98306619, 101106918), ('osE_19323', 194458049, 195486793, 197207469, 184473.212524, 197993089, 198659227, 200115510);
REPLACE INTO t_XP3o (c_oZlJWk, c_H9fn2ZM, c_OQ6HZnt, c_yhpUg, c_XqFrBM0, c_Rr6Nr, c_aXRgQZqf, c_2t6hgl) VALUES ('4eYyj4T_9323', 94847583, 95462471, 96991291, -462025.89, 98753094, 100053931, 99628674);
REPLACE INTO t_RyKA (c_7VKbFYLm, c_GkDm) SELECT 'tl7Z8Ynf4WpezUEfm8_9323', 'B_9423';
INSERT OR IGNORE INTO t_XtYasJ (c_ilYbxWW4JN, c_xMwO, c_S8Ikn, c_1cSWollN, c_kPd3voP, c_xBEHhUmfye, c_39sEIpBeuk, c_d8xO5525hG) VALUES (93278810, 93692783, 95778767, 95761659, 96326370, 98702631, 99479473, 101055552);
WITH cte_EcV AS (SELECT 1) REPLACE INTO t_XtYasJ (c_ilYbxWW4JN, c_xMwO, c_S8Ikn, c_1cSWollN, c_kPd3voP, c_xBEHhUmfye, c_39sEIpBeuk, c_d8xO5525hG) SELECT 92371480, 93636265, 94601109, 95555222, 97775848, 97500099, 99161931, 100473357;
REPLACE INTO t_XtYasJ (c_ilYbxWW4JN, c_xMwO, c_S8Ikn, c_1cSWollN, c_kPd3voP, c_xBEHhUmfye, c_39sEIpBeuk, c_d8xO5525hG) VALUES (92765779, 94266672, 95762130, 95588749, 96881496, 97839591, 98910970, 99311171), (192481646, 193721069, 195389151, 197197461, 196782094, 198870124, 199031518, 200060372);
REPLACE INTO t_eXbmsREJ (c_5HieIXCQS) VALUES (94080157), (193369026);
REPLACE INTO t_eXbmsREJ (c_5HieIXCQS) SELECT 93470303;
REPLACE INTO t_XP3o DEFAULT VALUES;
INSERT OR REPLACE INTO t_RyKA DEFAULT VALUES;



BEGIN TRANSACTION;
UPDATE OR IGNORE t_RyKA SET c_7VKbFYLm = 'VSJJ3_1747139323' WHERE ROWID = (SELECT MIN(ROWID) FROM t_RyKA);
REPLACE INTO t_RyKA (c_7VKbFYLm, c_GkDm) VALUES ('8nw_9323', 'P_9423');
INSERT OR IGNORE INTO t_RyKA (c_7VKbFYLm, c_GkDm) VALUES ('UR_9323', 'u4YNQ8MHgW7ciEm_9423');
COMMIT;

                    SELECT 
                        t1.c_d8xO5525hG,
                        (SELECT COUNT(*) FROM t_XtYasJ t2 WHERE t2.c_d8xO5525hG = t1.c_d8xO5525hG) as same_value_count,
                        CASE WHEN EXISTS(SELECT 1 FROM t_XtYasJ t3 WHERE t3.c_d8xO5525hG > t1.c_d8xO5525hG LIMIT 1) 
                            THEN 'Not Max' ELSE 'Max' END as is_max_value,
                        (SELECT COUNT(*) FROM (
                            SELECT DISTINCT c_d8xO5525hG FROM t_XtYasJ
                        )) as distinct_values_count
                    FROM t_XtYasJ t1
                    WHERE t1.c_d8xO5525hG IN (
                        SELECT c_d8xO5525hG 
                        FROM t_XtYasJ 
                        WHERE typeof(c_d8xO5525hG) NOT IN ('null')
                        GROUP BY c_d8xO5525hG
                        HAVING COUNT(*) > 0
                    )
                    ORDER BY (SELECT COUNT(*) FROM t_XtYasJ t4 WHERE t4.c_d8xO5525hG = t1.c_d8xO5525hG) DESC
                    LIMIT 10;
                    
SELECT t_XP3o.c_XqFrBM0 as t_XP3o_val, t_RyKA.c_GkDm as t_RyKA_val, t_eXbmsREJ.c_5HieIXCQS as t_eXbmsREJ_val
FROM t_XP3o
LEFT JOIN t_RyKA ON t_XP3o.ROWID = t_RyKA.ROWID
INNER JOIN t_eXbmsREJ ON t_XP3o.ROWID = t_eXbmsREJ.ROWID
WHERE t_eXbmsREJ.c_5HieIXCQS IS NOT NULL
ORDER BY t_XP3o.c_XqFrBM0
LIMIT 20;
WITH cte_Ufp AS (SELECT * FROM t_XP3o LIMIT 10) SELECT * FROM t_XtYasJ NATURAL JOIN t_eXbmsREJ WHERE t_XtYasJ.c_xBEHhUmfye GROUP BY c_5HieIXCQS ORDER BY 1 DESC LIMIT 44;
SELECT t_RyKA.c_GkDm, *, *, t_RyKA.c_GkDm FROM t_RyKA WHERE NOT LOWER(t_RyKA.c_7VKbFYLm) GROUP BY c_7VKbFYLm HAVING FALSE ORDER BY 1 LIMIT 53;
SELECT t_eXbmsREJ.c_5HieIXCQS FROM t_eXbmsREJ ORDER BY t_eXbmsREJ.c_5HieIXCQS ASC LIMIT 10;

                SELECT DISTINCT t_XtYasJ.c_d8xO5525hG,
                    COUNT(*) OVER (PARTITION BY t_XtYasJ.c_xBEHhUmfye) as window_count,
                    RANK() OVER (ORDER BY 
                            CASE WHEN typeof(t_XtYasJ.c_d8xO5525hG) IN ('null') THEN 0 
                            ELSE t_XtYasJ.c_d8xO5525hG END DESC,
                            t_XtYasJ.c_xBEHhUmfye ASC     /* Only use columns that definitely exist */
                    ) as rank_val,
                    CASE WHEN t_XtYasJ.c_d8xO5525hG IS NULL THEN 'Unknown' ELSE 'Known' END as status
                FROM t_XtYasJ
                WHERE t_XtYasJ.c_d8xO5525hG IS NOT NULL
                GROUP BY t_XtYasJ.c_d8xO5525hG, t_XtYasJ.c_xBEHhUmfye
                HAVING COUNT(*) > 0
                /* Only use columns that definitely exist in ORDER BY */
                ORDER BY t_XtYasJ.c_d8xO5525hG ASC, t_XtYasJ.c_xBEHhUmfye ASC, window_count DESC
                LIMIT 20;
                

                SELECT t_XtYasJ.c_d8xO5525hG,
                    t_XtYasJ.c_xBEHhUmfye,
                    SUM(CASE WHEN typeof(t_XtYasJ.c_d8xO5525hG) IN ('integer', 'real', 'numeric') THEN t_XtYasJ.c_d8xO5525hG ELSE 0 END) 
                        OVER (PARTITION BY t_XtYasJ.c_xBEHhUmfye ORDER BY t_XtYasJ.c_d8xO5525hG ASC) as window_total
                FROM t_XtYasJ
                GROUP BY t_XtYasJ.c_d8xO5525hG, t_XtYasJ.c_xBEHhUmfye
                HAVING SUM(CASE WHEN typeof(t_XtYasJ.c_d8xO5525hG) IN ('integer', 'real', 'numeric') THEN t_XtYasJ.c_d8xO5525hG ELSE 0 END) > 0
                ORDER BY window_total DESC, t_XtYasJ.c_d8xO5525hG ASC, t_XtYasJ.c_xBEHhUmfye ASC
                LIMIT 10;
                

--- v3.26.0 ---
OUT:
1
101055552|1|Not Max|4
100473357|1|Not Max|4
99311171|1|Not Max|4
200060372|1|Max|4
-540740.324|B_9423|94080157
840326.01446||193369026
1045521.53|P_9423|93470303
93278810|93692783|95778767|95761659|96326370|98702631|99479473|101055552|93470303
93278810|93692783|95778767|95761659|96326370|98702631|99479473|101055552|94080157
93278810|93692783|95778767|95761659|96326370|98702631|99479473|101055552|193369026
93470303
94080157
193369026
99311171|1|4|Known
100473357|1|3|Known
101055552|1|2|Known
200060372|1|1|Known
200060372|198870124|200060372
101055552|98702631|101055552
100473357|97500099|100473357
99311171|97839591|99311171

ERR:


--- v3.49.1 ---
OUT:
1
101055552|1|Not Max|4
100473357|1|Not Max|4
99311171|1|Not Max|4
200060372|1|Max|4
-540740.324|B_9423|94080157
840326.01446||193369026
1045521.53|P_9423|93470303
93278810|93692783|95778767|95761659|96326370|98702631|99479473|101055552|193369026
93278810|93692783|95778767|95761659|96326370|98702631|99479473|101055552|94080157
93278810|93692783|95778767|95761659|96326370|98702631|99479473|101055552|93470303
93470303
94080157
193369026
99311171|1|4|Known
100473357|1|3|Known
101055552|1|2|Known
200060372|1|1|Known
200060372|198870124|200060372
101055552|98702631|101055552
100473357|97500099|100473357
99311171|97839591|99311171

ERR:

