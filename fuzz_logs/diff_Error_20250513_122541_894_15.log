SQL:
PRAGMA threads = 0;
CREATE TEMP TABLE IF NOT EXISTS t_lRufpQDl (c_9rfIA25 NUMERIC, c_SjUph69Y NUMERIC, c_0Wm NUMERIC, c_XPnVS9w8 TEXT, c_A3iyBu9 INTEGER, c_gwb NUMERIC, PRIMARY KEY (c_A3iyBu9));
CREATE TABLE IF NOT EXISTS t_I76iQ4s (c_hnCk TEXT DEFAULT 'EPayQpuJ', c_5bZ3X INTEGER, c_oWNSHgJ2 TEXT COLLATE BINARY, FOREIGN KEY (c_5bZ3X) REFERENCES t_lbVMR(c_ICJRs));
REPLACE INTO t_lRufpQDl (c_9rfIA25, c_SjUph69Y, c_0Wm, c_XPnVS9w8, c_A3iyBu9, c_gwb) VALUES (91232414, 91979231, 92829583, 'vspJMRWQlsopxMuhJ7_9441', 94816759, 97146189), (190985239, 193082694, 194244259, '13Rq_19441', 194941330, 196589872);
INSERT OR IGNORE INTO t_lRufpQDl (c_9rfIA25, c_SjUph69Y, c_0Wm, c_XPnVS9w8, c_A3iyBu9, c_gwb) VALUES (92045566, 93064730, 92727892, '8mBm8XroDrQ_9441', 96279989, 95523579), (191782022, 191846358, 193062924, 'HwGbwCV6PcI9g6PrHEVq_19441', 194855285, 197077869);
INSERT OR REPLACE INTO t_lRufpQDl (c_9rfIA25, c_SjUph69Y, c_0Wm, c_XPnVS9w8, c_A3iyBu9, c_gwb) VALUES (91639750, 91571595, 92584134, 'rwlnWUOPxuPlbbYFlg_9441', 96058051, 96687863);
REPLACE INTO t_I76iQ4s (c_hnCk, c_5bZ3X, c_oWNSHgJ2) VALUES ('OC6Km_9141', 92153359, 'OprStPQfW78LRf_9341');
INSERT INTO t_lRufpQDl DEFAULT VALUES;


BEGIN TRANSACTION;
UPDATE OR IGNORE t_lRufpQDl SET c_A3iyBu9 = NULL WHERE ROWID = (SELECT MIN(ROWID) FROM t_lRufpQDl);
REPLACE INTO t_lRufpQDl (c_9rfIA25, c_SjUph69Y, c_0Wm, c_XPnVS9w8, c_A3iyBu9, c_gwb) VALUES (92280445, 92047061, 92694565, 'hIn3U3yhFtrV4qgbQVU_9441', 96379351, 96395520);
REPLACE INTO t_lRufpQDl (c_9rfIA25, c_SjUph69Y, c_0Wm, c_XPnVS9w8, c_A3iyBu9, c_gwb) VALUES (90762923, 92096404, 93776955, 'bAZ_9441', 96051053, 97365943), (190477572, 191827023, 193409301, 'vIf1_19441', 196073423, 195535968);
COMMIT;

                SELECT c_SjUph69Y, c_9rfIA25,
                    ROW_NUMBER() OVER (PARTITION BY c_9rfIA25) as row_num,
                    RANK() OVER (PARTITION BY c_9rfIA25 ORDER BY c_SjUph69Y) as rank_val,
                    DENSE_RANK() OVER (PARTITION BY c_9rfIA25 ORDER BY c_SjUph69Y) as dense_rank_val,
                    SUM(CASE WHEN typeof(c_SjUph69Y) IN ('integer','real') THEN c_SjUph69Y ELSE 0 END) 
                        OVER (PARTITION BY c_9rfIA25 ORDER BY c_SjUph69Y 
                            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) as running_total,
                    LAG(CASE WHEN typeof(c_SjUph69Y) IN ('integer','real') THEN c_SjUph69Y ELSE 0 END, 1, 0) 
                        OVER (PARTITION BY c_9rfIA25 ORDER BY c_SjUph69Y) as prev_value,
                    LEAD(CASE WHEN typeof(c_SjUph69Y) IN ('integer','real') THEN c_SjUph69Y ELSE 0 END, 1, 0) 
                        OVER (PARTITION BY c_9rfIA25 ORDER BY c_SjUph69Y) as next_value
                FROM t_lRufpQDl
                ORDER BY c_9rfIA25, c_SjUph69Y
                LIMIT 20;
                
SELECT t_lRufpQDl.c_A3iyBu9, t_lRufpQDl.c_gwb, t_lRufpQDl.c_XPnVS9w8, t_lRufpQDl.c_SjUph69Y FROM t_lRufpQDl ORDER BY t_lRufpQDl.c_A3iyBu9 DESC LIMIT 10;

--- v3.26.0 ---
OUT:
0
||1|1|1|0|0|0
92096404|90762923|1|1|1|92096404|0|0
91979231|91232414|1|1|1|91979231|0|0
91571595|91639750|1|1|1|91571595|0|0
93064730|92045566|1|1|1|93064730|0|0
92047061|92280445|1|1|1|92047061|0|0
191827023|190477572|1|1|1|191827023|0|0
193082694|190985239|1|1|1|193082694|0|0
191846358|191782022|1|1|1|191846358|0|0
196073423|195535968|vIf1_19441|191827023
194941331|||
194941330|196589872|13Rq_19441|193082694
194855285|197077869|HwGbwCV6PcI9g6PrHEVq_19441|191846358
96379351|96395520|hIn3U3yhFtrV4qgbQVU_9441|92047061
96279989|95523579|8mBm8XroDrQ_9441|93064730
96058051|96687863|rwlnWUOPxuPlbbYFlg_9441|91571595
96051053|97365943|bAZ_9441|92096404
94816759|97146189|vspJMRWQlsopxMuhJ7_9441|91979231

ERR:
Error: near line 12: datatype mismatch


--- v3.49.1 ---
OUT:
0
||1|1|1|0|0|0
92096404|90762923|1|1|1|92096404|0|0
91979231|91232414|1|1|1|91979231|0|0
91571595|91639750|1|1|1|91571595|0|0
93064730|92045566|1|1|1|93064730|0|0
92047061|92280445|1|1|1|92047061|0|0
191827023|190477572|1|1|1|191827023|0|0
193082694|190985239|1|1|1|193082694|0|0
191846358|191782022|1|1|1|191846358|0|0
196073423|195535968|vIf1_19441|191827023
194941331|||
194941330|196589872|13Rq_19441|193082694
194855285|197077869|HwGbwCV6PcI9g6PrHEVq_19441|191846358
96379351|96395520|hIn3U3yhFtrV4qgbQVU_9441|92047061
96279989|95523579|8mBm8XroDrQ_9441|93064730
96058051|96687863|rwlnWUOPxuPlbbYFlg_9441|91571595
96051053|97365943|bAZ_9441|92096404
94816759|97146189|vspJMRWQlsopxMuhJ7_9441|91979231

ERR:
Runtime error near line 12: datatype mismatch (20)

